<div class="{{ sq.selectedAnsweredState }} guide-wrapper" [ngClass]="sq.answered ? '' : 'notactive'">
    <div class="wrap-title">
        <!-- question text -->
        <div class="section-header-left">
            <div *ngIf="isAnswered()">
                <img
                    class="mart05"
                    src="/assets/assets/images/icon_question_type_ready_grey.png"
                    alt="question answered"
                    onerror="this.onerror=null;this.src='/assets/assets/images/icon_question_type_ready_grey.png';"
                />
            </div>
            <div *ngIf="!isAnswered()">
                <img
                    class="mart05"
                    src="/assets/assets/images/icon_question_type_waiting.svg"
                    alt="question not answered"
                    onerror="this.onerror=null;this.src='/assets/assets/images/icon_question_type_waiting.png';"
                />
            </div>
        </div>

        <!-- chevron -->
        <div class="section-header-right fa-stack fa-lg pointer section-box-title arrow" (click)="expanded = !expanded">
            <i
                [ngClass]="expanded ? 'fa-chevron-down sitnet-text' : 'fa-chevron-right sitnet-text-medium'"
                class="sitnet-text-medium fa fa-chevron-left fa-stack-1x"
            >
            </i>
        </div>

        <div class="section-header-middle" *ngIf="sq.question.type !== 'ClozeTestQuestion'">
            <div class="section-box-title" *ngIf="expanded" [MathJax]="sq.question.question"></div>
            <div class="section-box-title" *ngIf="!expanded" [MathJax]="sq.question.question | truncate: 240"></div>
        </div>
        <div class="section-header-middle" *ngIf="sq.question.type === 'ClozeTestQuestion'">
            <div class="section-box-title" mathjax>
                <dynamic-form [questions]="clozeTestFormQuestions" (onAnswer)="answered($event)"></dynamic-form>
                <!--cloze-test [content]="clozeTestAnswer.question" [results]="clozeTestAnswer.answer"></cloze-test-->
                <!-- TODO: chevron click. Truncate is bit tricky here. Maybe add a separate header for chevron click? -->
            </div>
        </div>
    </div>

    <!-- instruction -->
    <div class="row mart10" *ngIf="sq.answerInstructions && expanded">
        <div class="col-md-12">
            <p class="question-text question-type-text info">
                <img
                    class="marr20"
                    src="/assets/assets/images/icon_info.svg"
                    alt="info icon"
                    onerror="this.onerror=null;this.src='/assets/assets/images/icon_info.png';"
                />
                {{ 'sitnet_instructions' | translate }}:&nbsp;{{ sq.answerInstructions }}
            </p>
        </div>
    </div>

    <!-- attachment -->
    <div class="row mart10" *ngIf="sq.question.attachment && expanded">
        <div class="col-md-12">
            <a class="pointer green_button left-floater-for-section" (click)="downloadQuestionAttachment()">
                {{ 'sitnet_download_section_question_attachment' | translate }}
                <img
                    src="/assets/assets/images/icon_attachment.svg"
                    alt="attachment"
                    onerror="this.onerror=null;this.src='/assets/assets/images/icon_attachment.png';"
            /></a>
            <div class="attachment-name">{{ sq.question.attachment.fileName | uppercase }}</div>
        </div>
    </div>

    <!-- answer -->
    <div class="exam-question-container" [hidden]="!expanded">
        <hr class="info-question-separator" />
        <div class="question" [ngSwitch]="sq.question.type">
            <examination-essay-question *ngSwitchCase="'EssayQuestion'" [sq]="sq" [exam]="exam" [isPreview]="isPreview">
            </examination-essay-question>

            <examination-cloze-test *ngSwitchCase="'ClozeTestQuestion'" [sq]="sq" [examHash]="exam.hash">
            </examination-cloze-test>

            <examination-multi-choice-question
                *ngSwitchCase="'MultipleChoiceQuestion'"
                [sq]="sq"
                [examHash]="exam.hash"
                [isPreview]="isPreview"
                [isCollaborative]="isCollaborative"
                [orderOptions]="!exam.external"
            >
            </examination-multi-choice-question>

            <examination-multi-choice-question
                *ngSwitchCase="'ClaimChoiceQuestion'"
                [sq]="sq"
                [examHash]="exam.hash"
                [isPreview]="isPreview"
                [isCollaborative]="isCollaborative"
                [orderOptions]="true"
            >
            </examination-multi-choice-question>

            <examination-weighted-multi-choice-question
                *ngSwitchCase="'WeightedMultipleChoiceQuestion'"
                [sq]="sq"
                [examHash]="exam.hash"
                [isPreview]="isPreview"
                [orderOptions]="!exam.external"
            >
            </examination-weighted-multi-choice-question>
        </div>
    </div>
</div>
