<!--
SPDX-FileCopyrightText: 2024 The members of the EXAM Consortium

SPDX-License-Identifier: EUPL-1.2
-->

<div [formGroup]="weightedMcForm">
    <div [hidden]="!multichoiceFeaturesOn()">
        <div class="row mt-2 mx-2">
            <ul>
                <li>{{ 'i18n_weighted_multiple_choice_description_1' | translate }}</li>
                <li>{{ 'i18n_weighted_multiple_choice_description_2' | translate }}</li>
                <li>{{ 'i18n_weighted_multiple_choice_description_3' | translate }}</li>
            </ul>
            {{ 'i18n_weighted_multiple_choice_description_4' | translate }}
            <ul>
                <li>{{ 'i18n_weighted_multiple_choice_description_5' | translate }}</li>
                <li>{{ 'i18n_weighted_multiple_choice_description_6' | translate }}</li>
                <li>{{ 'i18n_weighted_multiple_choice_description_7' | translate }}</li>
            </ul>
        </div>
        <div class="row mt-2" [formGroup]="weightedMcForm">
            <div class="col-md-12">
                <div class="form-check">
                    <input
                        class="form-check-input"
                        name="negativeScore"
                        type="checkbox"
                        formControlName="negativeScore"
                        id="negativeScore"
                    />
                    <label class="form-check-label" for="negativeScore">{{
                        'i18n_allow_negative_score' | translate
                    }}</label>
                </div>
            </div>
        </div>
        <div class="row mt-2" [formGroup]="weightedMcForm">
            <div class="col-md-12">
                <div class="form-check">
                    <input
                        class="form-check-input"
                        name="shuffleOptions"
                        type="checkbox"
                        formControlName="optionShuffling"
                        id="shuffleOptions"
                    />
                    <label class="form-check-label" for="shuffleOptions">{{
                        'i18n_shuffle_options' | translate
                    }}</label>
                </div>
            </div>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-md-6">
            <span class="question-option-title">{{ 'i18n_option' | translate }}</span>
            <span>
                @if (showWarning()) {
                    <div class="edit-warning-container">
                        <i class="bi-exclamation-circle text-danger"></i>
                        <small class="ps-2">{{ 'i18n_shared_question_property_info_multi_choice' | translate }}</small>
                    </div>
                }
            </span>
        </div>
        <div class="col-md-6 question-option-title">
            {{ 'i18n_word_points' | translate | uppercase }}
        </div>
    </div>

    <div formArrayName="options">
        @for (optionGroup of optionsFormArray.controls; track $index; let i = $index) {
            <div class="row">
                <div class="col-md-12">
                    <div [formGroupName]="i" class="m-0 p-0">
                        <div class="row my-2">
                            <div class="col-md-6 me-3 question-option-empty" [ngClass]="getOptionStyle(optionGroup)">
                                <textarea
                                    id="optionText-{{ i }}"
                                    name="optionText-{{ i }}"
                                    type="text"
                                    rows="1"
                                    class="question-option-input form-control"
                                    formControlName="optionText"
                                    required
                                ></textarea>
                            </div>
                            <div class="col-md-2 question-option-empty-radio" [ngClass]="getOptionStyle(optionGroup)">
                                <input
                                    id="optionScore-{{ i }}"
                                    name="optionScore-{{ i }}"
                                    class="question-option-input points"
                                    type="number"
                                    step="any"
                                    lang="en"
                                    formControlName="defaultScore"
                                    xmFixedPrecision
                                    required
                                />
                            </div>
                            <button
                                class="col-md-1 question-option-trash pointer btn btn-link"
                                [disabled]="!allowOptionRemoval() || lotteryOn()"
                                (click)="removeOption(i)"
                                [title]="getRemoveTooltip(i)"
                            >
                                <i class="bi-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

    <div class="row mt-3">
        <div class="col-md-12 question-option-title">
            {{ 'i18n_max_score' | translate | uppercase }}: {{ calculateDefaultMaxPoints() }}
            {{ 'i18n_min_score' | translate | uppercase }}: {{ calculateDefaultMinPoints() }}
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-12">
            <button type="button" (click)="addNewOption()" class="btn btn-sm btn-link">
                <i class="bi-plus" aria-hidden="true"></i>
                {{ 'i18n_question_add_new_option' | translate }}
            </button>
        </div>
    </div>
</div>
