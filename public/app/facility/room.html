<div id="sitnet-header" class="header">
    <div class="col-md-12 header-wrapper">
        <span class="header-text" ng-hide="editingMultipleRooms()">{{'sitnet_examination_location' | translate}}</span>
        <span class="header-text" ng-show="editingMultipleRooms()">{{'sitnet_edit_all_rooms' | translate}}</span>
    </div>
</div>
<div id="dashboard">
    <div class="main-row">
        <div class="col-md-12" ng-hide="editingMultipleRooms()">
            <form role="form" name="roomForm" novalidate id="room">
                <div class="row">
                    <span class="col-md-6" ng-init="showName = true">
                        <span ng-show="showName" onclick="document.getElementById('name_field').select();">
                            <span class="room-name" ng-click="showName = !showName">
                                {{roomInstance.name}} <i class="fa fa-pencil"></i>
                            </span>
                            <a class="room-name" ng-click="disableRoom(roomInstance)"
                               popover-placement="left" popover-trigger="mouseenter"
                               uib-popover="{{'sitnet_inactivate_room' | translate}}">
                                <i class="sitnet-red fa fa-times"></i>
                            </a>
                        </span>
                        <span ng-show="!showName">
                            <span class="form-group">
                                <input id="name_field" type="text" name="name" class="form-control input-lg"
                                       ng-model="roomInstance.name" autofocus
                                       required ng-pattern="/^(?!\s*$).+/"
                                       ng-blur="showName = !showName; roomForm.name.$valid ? updateRoom(roomInstance) : false">
                            </span>
                            <button class="btn-primary"
                                    ng-click="showName = !showName; roomForm.name.$valid ? updateRoom(roomInstance) : false">
                                <i class="fa fa-check"></i>
                            </button>
                        </span>
                    </span>
                </div>
                <!-- Room Code & Building name -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="sitnet-info-text">{{'sitnet_room_code' | translate}}</div>
                        <div class="input-group">
                            <input type="text" name="roomCode" class="form-control ng-pristine ng-valid"
                                   ng-model="roomInstance.roomCode"
                                   required ng-pattern="/^(?!\s*$).+/"
                                   ui-change="roomForm.roomCode.$valid ? updateRoom(roomInstance) : false">
                                    <span class="input-group-addon">
                                        <i class="fa fa-question-circle fa-fw" popover-placement="left"
                                           popover-trigger="mouseenter"
                                           uib-popover="{{'sitnet_exam_room_unique_code' | translate}}"></i>
                                    </span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="sitnet-info-text">{{'sitnet_room_building_name' | translate}}</div>
                        <div class="input-group">
                            <input type="text" name="buildingName" class="form-control ng-pristine ng-valid"
                                   ng-model="roomInstance.buildingName"
                                   ui-change="updateRoom(roomInstance)">
                                        <span class="input-group-addon">
                                            <i class="fa fa-question-circle fa-fw" popover-placement="left"
                                               popover-trigger="mouseenter"
                                               uib-popover="{{'sitnet_building_where_the_machine_is' | translate}}"></i>
                                        </span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- Campus & Organization name -->
                    <div class="bottom-padding-2">
                        <div class="col-md-6">
                            <div class="sitnet-info-text">{{'sitnet_room_campus' | translate}}</div>
                            <div class="input-group">
                                <input type="text" class="form-control ng-pristine ng-valid"
                                       ng-model="roomInstance.campus"
                                       ui-change="updateRoom(roomInstance)">
                                        <span class="input-group-addon">
                                            <i class="fa fa-question-circle fa-fw" popover-placement="left"
                                               popover-trigger="mouseenter"
                                               uib-popover="{{'sitnet_campus_where_room_is' | translate}}"></i>
                                        </span>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="top-row">
        <h3 class="col-md-12 header-text">{{'sitnet_room_default_working_hours' | translate}}</h3>
    </div>
    <div class="bottom-row">
        <div class="col-md-12" ng-include="hoursTemplate"></div>
    </div>

    <div class="detail-row">
        <h3 class="col-md-12 header-text">{{'sitnet_exam_starting_hours' | translate }}</h3>
    </div>
    <div class="bottom-row">
        <form>
            <div class="col-md-12">
                <div class="sitnet-info-text">{{'sitnet_minutes_on_the_hour' | translate }}:</div>
                <input id="hourOffset" type="number" min="0" max="59" ng-model="roomInstance.examStartingHourOffset"
                       ui-change="setStartingHourOffset()">
            </div>
        </form>
    </div>
    <div class="detail-row">
        <div class="col-md-6">
            <span ng-repeat="hour in examStartingHours" class="label pointer"
                  ng-class="hour.selected ? 'label-success' : 'label-default'"
                  ng-click="hour.selected = !hour.selected" style="margin: 0.2em">{{hour.startingHour}}</span>
        </div>
    </div>
    <div class="bottom-row">
        <div class="col-md-12">
            <a class="pointer" ng-click="toggleAllExamStartingHours()">{{'sitnet_add_remove_all' | translate }}</a>
        </div>
    </div>
    <div class="bottom-row">
        <div class="col-md-12">
            <button class="btn btn-sm btn-primary" ng-click="updateStartingHours()"
                    ng-disabled="!anyStartingHoursSelected()">{{'sitnet_save' | translate}}
            </button>
        </div>
    </div>

    <div class="top-row">
        <h3 class="col-md-12 header-text">{{'sitnet_exception_datetimes' | translate}}</h3>
    </div>

    <div ng-switch on="editingMultipleRooms()">
        <div ng-switch-when="true" massEditedRooms()>
            <div class="detail-row-tall" ng-repeat="room in rooms | filter: massEditedRoomFilter | orderBy:'name'">
                <div class="col-md-12">
                    <b>{{room.name}}</b>
                </div>
                <div class="detail-row"
                     ng-repeat="exception in room.calendarExceptionEvents | filter: massEditedExceptionFilter">
                    <div class="col-md-3">
                        {{formatDate(exception)}}
                    </div>
                    <div class="col-md-3 text-danger" ng-show="exception.outOfService">
                        {{ 'sitnet_room_out_of_service' | translate }}
                    </div>
                    <div class="col-md-3 text-info" ng-hide="exception.outOfService">
                        {{ 'sitnet_room_in_service' | translate }}
                    </div>
                    <div class="col-md-3">
                        <a class="pointer" ng-click="deleteException(exception)">{{'sitnet_exam_remove' |
                            translate}}</a>
                    </div>
                </div>
                <!--<br/>-->
            </div>
        </div>
        <div ng-switch-default>
            <div class="detail-row" ng-repeat="exception in roomInstance.calendarExceptionEvents">
                <div class="col-md-3">
                    {{formatDate(exception)}}
                </div>
                <div class="col-md-3 text-danger" ng-show="exception.outOfService">
                    {{ 'sitnet_room_out_of_service' | translate }}
                </div>
                <div class="col-md-3 text-info" ng-hide="exception.outOfService">
                    {{ 'sitnet_room_in_service' | translate }}
                </div>
                <div class="col-md-6">
                    <a class="pointer" ng-click="deleteException(exception)">{{'sitnet_exam_remove' | translate}}</a>
                </div>
            </div>
        </div>
    </div>
    <div class="main-row">
        <div class="col-md-12">
            <button ng-click="addException()" class="btn btn-primary">
                {{'sitnet_add' | translate}}
            </button>
        </div>
    </div>
    <!-- Accessibility information -->
    <div class="detail-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-12">
            <div class="sitnet-info-text">{{'sitnet_room_accessibility_info' | translate}}</div>
            <multiselect
                data-multiple="true"
                ng-model="roomInstance.accessibility"
                ms-header="{{'sitnet_select' | translate}}"
                ms-selected="{{selectedAccessibilities()}}"
                options="access.name for access in accessibilities"
                change="updateAccessibility(roomInstance)"
                data-compare-by="id">
            </multiselect>
        </div>
    </div>

    <!-- Guidance & Contact person information -->
    <div class="detail-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_guidance' | translate}}</div>
            <div class="input-group">
                <!--<input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomInstruction"-->
                <!--ui-change="updateRoom(roomInstance)">-->
                <textarea class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomInstruction"
                          ui-change="updateRoom(roomInstance)" placeholder="fin">
                </textarea>
                <textarea class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomInstructionEN"
                          ui-change="updateRoom(roomInstance)" placeholder="eng">
                </textarea>
                <textarea class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomInstructionSV"
                          ui-change="updateRoom(roomInstance)" placeholder="swe">
                </textarea>
                <span class="input-group-addon">
                    <i class="fa fa-question-circle fa-fw" popover-placement="left" popover-trigger="mouseenter"
                       uib-popover="{{'sitnet_instructions_for_use_of_room' | translate}}"></i>
                </span>
            </div>
        </div>

        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_contact_person' | translate}}</div>
            <div class="input-group">
                <input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.contactPerson"
                       ui-change="updateRoom(roomInstance)"/>
                <span class="input-group-addon">
                    <i class="fa fa-question-circle fa-fw" popover-placement="left" popover-trigger="mouseenter"
                       uib-popover="{{'sitnet_person_to_contact_if_need_info' | translate}}"></i>
                </span>
            </div>
        </div>
    </div>

    <!-- Video recordings URL -->
    <div class="detail-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_videorecordings_url' | translate}}</div>
            <div class="input-group">
                <input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.videoRecordingsURL"
                       ui-change="updateRoom(roomInstance)">
                    <span class="input-group-addon">
                        <i class="fa fa-question-circle fa-fw" popover-placement="left" popover-trigger="mouseenter"
                           uib-popover="{{'sitnet_address_for_camera_footage_from_this_room' | translate}}"></i>
                    </span>
            </div>
        </div>
    </div>

    <!-- Postal address-->
    <div class="main-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-12">
            <!-- Address -->
            <h3>{{'sitnet_exam_room_address' | translate }}</h3>

            <div id="address" class="machines-section" ng-include="addressTemplate"/>
        </div>
    </div>

    <!-- Service status -->
    <div class="top-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-12">
            <input type="checkbox" ng-model="roomInstance.outOfService" ng-change="updateRoom(roomInstance)">
            <strong>{{'sitnet_out_of_service' | translate}}</strong>
        </div>
    </div>
    <div class="detail-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-12 sitnet-info-text">{{'sitnet_reason' | translate}}</div>
    </div>
    <div class="bottom-row" ng-hide="editingMultipleRooms()">
        <div class="col-md-6">
            <div class="input-group">
                <textarea ng-disabled="!roomInstance.outOfService" class="form-control ng-pristine ng-valid"
                          ng-model="roomInstance.statusComment"
                          ui-change="updateRoom(roomInstance)">
                </textarea>
                <span class="input-group-addon">
                    <i class="fa fa-question-circle fa-fw" popover-placement="left" popover-trigger="mouseenter"
                       uib-popover="{{'sitnet_room_accessibility_features' | translate}}"></i>
                </span>
            </div>
        </div>
    </div>

    <!-- Button row -->
    <div class="main-row">
        <div class="col-md-12">
            <button ng-disabled="!roomForm.$valid" ng-click="saveRoom(roomInstance)" class="btn btn-primary">
                {{'sitnet_save' | translate}}
            </button>
        </div>
    </div>
</div>
