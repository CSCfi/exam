<!-- Refresh MathJax syntax some time after page was rendered -->
<script type="text/javascript">
    $(document).ready(function () {
        setTimeout(function () {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }, 500);
    });

</script>

<div id="sitnet-header" class="header">
    <div class="col-sm-8 header-wrapper">
        <span class="header-text">{{'sitnet_exam_review' | translate}}</span>
        <span class="header-text">

            <a ng-click="printExam()" class="btn btn-primary btn-xs" aria-label="Left Align">
                {{'sitnet_print' | translate}}&nbsp;&nbsp;
                <span class="glyphicon glyphicon-print" aria-hidden="true"></span>
            </a>

        </span>
    </div>
    <div class="col-sm-4 header-wrapper">
        <span class="pull-right horizontal-padding-1 sitnet-text-medium col-sm-12">
            <span class="pull-right">{{'sitnet_inspection_status' | translate}}:</span>
        </span>
        <span class="pull-right horizontal-padding-1 col-sm-12">
            <span ng-if="examToBeReviewed.state === 'ABORTED'"
                  class="pull-right sitnet-text-alarm small">{{'sitnet_aborted_exam' | translate}}
            </span>
            <span ng-if="examToBeReviewed.state ==='REVIEW' || examToBeReviewed.state === 'REVIEW_STARTED'  || examToBeReviewed.state === 'STUDENT_STARTED'"
                  class="pull-right text-success small">{{'sitnet_exam_status_' + examToBeReviewed.state | lowercase | translate}}
            </span>
            <span ng-if="examToBeReviewed.state === 'GRADED'" class="pull-right text-info small">
                {{'sitnet_exam_status_' + examToBeReviewed.state | lowercase | translate}}
            </span>
            <span ng-if="examToBeReviewed.state === 'GRADED_LOGGED'" class="pull-right text-muted small">
                {{'sitnet_exam_status_' + examToBeReviewed.state | lowercase | translate}}
            </span>
        </span>
    </div>
</div>

<div id="dashboard">
    <div class="main-row">
        <div class="col-sm-12">
            <h4>
                {{examToBeReviewed.course.code}} - {{examToBeReviewed.name}}, {{examToBeReviewed.course.credits}} op
            </h4>
        </div>
    </div>

    <!-- General Information -->
    <div ng-include="generalInfoPath"></div>

    <div class="main-row">
        <strong class="col-sm-12">{{'sitnet_questions' | translate}}:</strong>
    </div>

    <!-- Sections -->
    <div ng-include="reviewSectionPath" ng-repeat="section in examToBeReviewed.examSections"></div>

    <!-- Grading -->
    <div ng-include="gradingPath"></div>

    <!-- Floating feedback window -->
    <div id="exam" class="col-sm-11" ng-hide="(isGraded && !isCreatorOrOwnerOrAdmin()) || isReadOnly">
        <div ng-init="hideEditor = true" class="col-sm-5 col-sm-offset-4 review-feedback" bs-affix data-offset-top="150">
            <div class="review-feedback" ng-click="hideEditor = toggleFeedbackHiding(hideEditor)">
                        <span>
                            <i class="fa fa-2x" ng-class="!hideEditor ? 'fa-chevron-circle-right sitnet-green' :
                               'fa-chevron-circle-down sitnet-red'">
                            </i>
                        </span>
                        <span class="col-sm-offset-2 review-feedback-text" ng-show="!hideEditor">
                            {{'sitnet_give_feedback' | translate}}</span>
                        <span class="col-sm-offset-2 review-feedback-text" ng-show="hideEditor">
                            {{'sitnet_hide_feedback' | translate}}
                        </span>
            </div>
            <div class="row" ng-show="hideEditor">
                <textarea ck-editor rows="10" ng-model="examToBeReviewed.examFeedback.comment"></textarea>
            </div>
            <div class="main-row pull-right" ng-show="hideEditor">
                <span ng-controller="AttachmentController" ng-show="examToBeReviewed.examFeedback && examToBeReviewed.examFeedback.attachment">
                    <a class="pointer" ng-click="downloadFeedbackAttachment(examToBeReviewed)">{{examToBeReviewed.examFeedback.attachment.fileName}}</a>
                    <span class="sitnet-red pointer" ng-click="removeFeedbackAttachment(examToBeReviewed)">
                        <i class="fa fa-times" title="{{'sitnet_remove_attachment' | translate }}"></i>
                    </span>
                </span>
                <span>
                    <button class="btn btn-default" ng-click="selectFile()">{{'sitnet_attach_file' | translate}}</button>
                </span>
            </div>
        </div>
    </div>

</div>
