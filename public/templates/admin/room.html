<div id="sitnet-header" class="header">
    <div class="col-md-12 header-wrapper">
        <span class="header-text">{{'sitnet_examination_location' | translate}}</span>
    </div>
</div>
<div id="room">
<form class="form-inline" role="form" name="roomForm" novalidate>
    <div class="row base">
        <div class="col-md-9 " ng-init="showName = true">
            <div ng-show="showName" onclick="document.getElementById('name_field').select();">
                <span class="pull-left room-name" ng-click="showName = !showName">
                    {{roomInstance.name}} <i class="fa fa-pencil"></i>
                </span>
            </div>
            <div ng-show="!showName">
                <div class="form-group">
                    <input id="name_field" type="text" name="name" class="form-control input-lg" ng-model="roomInstance.name" autofocus
                           required ng-pattern="/^(?!\s*$).+/" ng-blur="showName = !showName; roomForm.name.$valid ? updateRoom(roomInstance) : false">
                </div>
                <button class="btn-primary" ng-click="showName = !showName; roomForm.name.$valid ? updateRoom(roomInstance) : false">
                    <i class="fa fa-check"></i>
                </button>
            </div>
        </div>
        <div class="col-md-3 ">
            <a ng-click="removeRoom(roomInstance)" class="header-icon pull-right fa-stack fa-lg"
               popover-placement="top" popover-trigger="mouseenter" popover="Poista tenttitila">
                <i class="fa sitnet-text-light fa-stop fa-stack-2x"></i>
                <i class="sitnet-red fa fa-times fa-stack-1x"></i>
            </a>
        </div>
    </div>
    <!-- Room Code & Building name -->
    <div class="row base">
        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_code' | translate}}</div>
            <div class="input-group">
                <input type="text" name="roomCode" class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomCode"
                       required ng-pattern="/^(?!\s*$).+/" ui-change="showName = !showName; roomForm.roomCode.$valid ? updateRoom(roomInstance) : false">
                        <span class="input-group-addon"
                              popover-placement="top" popover-trigger="mouseenter" popover="Tenttitilan yksilöivä tunniste. Esim: IT101">
                            <i class="fa fa-question-circle fa-fw"></i>
                        </span>
            </div>
        </div>

        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_building_name' | translate}}</div>
            <div class="input-group">
                <input type="text" name="buildingName" class="form-control ng-pristine ng-valid" ng-model="roomInstance.buildingName"
                       ui-change="updateRoom(roomInstance)">
                            <span class="input-group-addon"
                                  ng-click="toaster.info('Rakennuksen nimi jossa kone sijaitsee');">
                                <i class="fa fa-question-circle fa-fw"></i>
                            </span>
            </div>
        </div>
    </div>

    <!-- Campus & Organization name -->
    <div class="row base">
        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_campus' | translate}}</div>
            <div class="input-group">
                <input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.campus"
                       ui-change="updateRoom(roomInstance)">
                        <span class="input-group-addon"
                              ng-click="toaster.info('Kampus, jossa tenttitila sijaitsee');">
                            <i class="fa fa-question-circle fa-fw"></i>
                        </span>
            </div>
        </div>

        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_organization' | translate}}</div>
            <div class="input-group">
                <input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.organization"
                       ui-change="updateRoom(roomInstance)">
                            <span class="input-group-addon"
                                  ng-click="toaster.info('Organisaatio, joka tenttitilan omistaa');">
                                <i class="fa fa-question-circle fa-fw"></i>
                            </span>
            </div>
        </div>
    </div>

    <div class="row base">
        <h2 class="header-text generic-header">{{'sitnet_room_default_working_hours' | translate}}</h2>
        <div class="col-md-12" ng-include="hoursTemplate"></div>
    </div>
    <div class="row base">
        <h2 class="header-text generic-header">{{'sitnet_exception_datetimes' | translate}}</h2>
        <div class="col-md-12">
            <div class="col-md-12">
                <table class="table table-bordered">
                    <thead>
                    <tr>
                        <th>Päivämäärä</th>
                        <th>Aika</th>
                        <th>Poista</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat='exception in roomInstance.calendarExceptionEvents'>
                        <td>{{formatDate(exception)}}</td>
                        <td>{{formatTime(exception)}}</td>
                        <td>
                            <button ng-click="deleteException(exception)" class="btn btn-sm btn-danger">
                                {{'sitnet_remove_exception_time' | translate}}
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="col-md-12">
            <button ng-click="addException()" class="btn btn-primary">
                {{'sitnet_add_exception_time' | translate}}
            </button>
        </div>
    </div>
    <div class="row base">
        <div class="col-md-6">

            <div class="sitnet-info-text">{{'sitnet_room_transition_time' | translate}} ({{'sitnet_minutes' | translate}})</div>
            <div class="input-group">
                <input type="text" name="transitionTime" class="form-control ng-pristine ng-valid" ng-model="roomInstance.transitionTime"
                       ui-change="roomForm.transitionTime.$valid ? updateRoom(roomInstance) : false" required ng-pattern="/^\d*(\.\d+)?$/">
                    <span class="input-group-addon" popover-placement="top" popover-trigger="mouseenter" popover="Siirtymäaika on jakso, joka varataan tenttisuoritusten välille.">
                        <i class="fa fa-question-circle fa-fw"></i>
                    </span>
            </div>
        </div>
    </div>

    <!-- Accessibility information -->
    <div class="row base">
        <div class="col-md-12">
            <div class="sitnet-info-text">{{'sitnet_room_accessibility_info' | translate}}</div>
            <div class="col-md-6" >
 <!--
             <div ng-repeat='access in roomInstance.accessibility'>{{access.name}}<a ng-click="removeAccessibility(access)"> poista</a></a></div>

             <input type="text" class="form-control ng-pristine ng-valid" ng-model="newAccessibility">
                <button ng-click="addAccessibility(newAccessibility)" class="btn btn-sm btn-default">
                    {{'sitnet_add' | translate}}
                </button>
                <div class="checkbox">
                    <label>
                        <input type="checkbox" ng-model="roomInstance.accessible" ng-change="updateRoom(roomInstance)">
                        {{'sitnet_room_accessible' | translate}}
                    </label>
                </div>
            </div>       -->
                                <multiselect class="input-xlarge"
                                 multiple="true"
                                 ng-model="roomInstance.accessibility"
                                 header="{{'sitnet_select' | translate}}"
                                 multiheader="selectedAccessibilities()"
                                 options="access.name for access in accessibilities"
                                 change="updateAccessibility(roomInstance)" ></multiselect>

            <!--div class="input-group">
                <textarea class="form-control ng-pristine ng-valid" ng-model="roomInstance.accessibilityInfo"
                          ui-change="updateRoom(roomInstance)">
                </textarea>
                            <span class="input-group-addon"
                                  ng-click="toaster.info('Onko tilassa erityisiä esteettömyyteen vaikuttavia tekijöitä?');">
                                <i class="fa fa-question-circle fa-fw"></i>
                            </span>
            </div-->

        </div>
    </div>

    <!-- Guidance & Contact person information -->
    <div class="row base">
        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_guidance' | translate}}</div>
            <div class="input-group">
                <!--<input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomInstruction"-->
                <!--ui-change="updateRoom(roomInstance)">-->
                <textarea class="form-control ng-pristine ng-valid" ng-model="roomInstance.roomInstruction"
                          ui-change="updateRoom(roomInstance)">
                </textarea>
                        <span class="input-group-addon"
                              ng-click="toaster.info('Tenttitilan käyttämiseen liittyvä ohjeistus');">
                            <i class="fa fa-question-circle fa-fw"></i>
                        </span>
            </div>
        </div>

        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_contact_person' | translate}}</div>
            <div class="input-group">
                <input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.contactPerson" ui-change="updateRoom(roomInstance)">
                <span class="input-group-addon" ng-click="toaster.info('Ota yhteyttä tähän henkilöön lisätietoa kaivatessasi');">
                    <i class="fa fa-question-circle fa-fw"></i>
                </span>
            </div>
        </div>
    </div>

    <!-- Video recordings URL -->
    <div class="row base">
        <div class="col-md-6">
            <div class="sitnet-info-text">{{'sitnet_room_videorecordings_url' | translate}}</div>
            <div class="input-group">
                <input type="text" class="form-control ng-pristine ng-valid" ng-model="roomInstance.videoRecordingsURL"
                       ui-change="updateRoom(roomInstance)">
                            <span class="input-group-addon"
                                  ng-click="toaster.info('Tästä osoitteesta löytyy tenttihuoneen videokameralla kuvatut otokset');">
                                <i class="fa fa-question-circle fa-fw"></i>
                            </span>
            </div>
        </div>
    </div>

    <!-- Postal address-->
    <div class="row base">
        <div class="col-md-12">
            <!-- Address -->
            <h3>{{'sitnet_exam_room_postal_address' | translate }}</h3>

            <div id="address" class="machines-section" ng-include="addressTemplate"/>
        </div>
    </div>

    <!-- Service status -->
    <div class="row base">
        <div class="col-md-12">
            <div class="checkbox">
                <label>
                    <input type="checkbox" ng-model="roomInstance.outOfService" ng-change="updateRoom(roomInstance)">
                    {{'sitnet_out_of_service' | translate}}
                </label>
            </div>
            <div class="sitnet-info-text">{{'sitnet_reason' | translate}}</div>
            <div class="input-group">
                <textarea ng-disabled="!roomInstance.outOfService" class="form-control ng-pristine ng-valid" ng-model="roomInstance.statusComment"
                          ui-change="updateRoom(roomInstance)">
                </textarea>
                <span class="input-group-addon"
                      ng-click="toaster.info('Onko tilassa erityisiä esteettömyyteen vaikuttavia tekijöitä?');">
                    <i class="fa fa-question-circle fa-fw"></i>
                </span>
            </div>
        </div>
    </div>

    <!-- Exam room machines
    <div>
        <h3>{{'sitnet_exam_room_machines' | translate }}
            <span>
                <button ng-click="addNewMachine(roomInstance)" class="btn btn-primary" style="float: right">{{'sitnet_create_new' | translate}}</button>
            </span>
        </h3>
    </div>
    <div id="reservation" class="machines-section" ng-include="machineTemplate" ng-repeat="machine in roomInstance.examMachines"
         style="padding-left: 1em; margin-bottom: 2em">
    </div>
    -->
    <!-- Button row -->
    <div class="row base" style="padding:2em 0;">
        <div class="col-md-6 col-md-offset-5">
            <button ng-disabled="!roomForm.$valid" ng-click="saveRoom(roomInstance)" class="btn btn-primary">{{'sitnet_save' | translate}}</button>
        </div>
    </div>
</form>
</div>